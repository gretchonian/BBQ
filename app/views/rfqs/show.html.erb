
<script>
  $(function() {
    $('.meat').change(function(e) {
      // var meatBox = $( this );
      // console.log($input);
      var meatBoxesToCheck = $('li input[type="checkbox"]');
      var meatId = $(e.target).data("value");
      var meatName = $(e.target).data("text");
      var meatBoxChecked = $(e.target);
      var checkedStatus = meatBoxChecked.selected ? "checked" : "";
      meatBoxChecked.change(checkedStatus);
      console.log(meatBoxChecked);
      console.log(meatName);
            
  //     meatBoxesToCheck.each(function() {
  //       var meatBox = this;
        
          if (this.checked == true) {
  //           var meatName = $(e.target).data("meat");
            var meatId = $(e.target).data("value");
  //           var rfqId = $(e.target).data("rfq");
            var selectedMeat = Boolean($(e.target).is(':checked'));  
  //           // console.log("meatName:" + meatName);
  //           // console.log("meatId:" + meatId);
  //           // console.log("rfqId:" + rfqId);
  //           // console.log("selectedMeat:" + selectedMeat);
  //           // console.log("meatbox:"+ meatBox);
            $.ajax({
              type: 'PUT',
              url: "/foods/" + meatId,
              data: { food: {selected: selectedMeat} },
            });
          } else {
            var deSelectedMeat = Boolean($(e.target).is(''));
             $.ajax({
              type: 'PUT',
              url: "/foods/" + meatId,
              data: { food: {selected: deSelectedMeat} },
            });
          }
  //     })
  //   // $( ".meat" ).html(
  //   //           ".attr( \"checked\" ): <b>" + meatBoxChecked.attr( "checked" ) + "</b><br>" +
  //   //           ".prop( \"checked\" ): <b>" + meatBoxChecked.prop( "checked" ) + "</b><br>" +
  //   //           ".is( \":checked\" ): <b>" + meatBoxChecked.is( ":checked" ) + "</b>" );
  //   //           }).change();
    });
  });
</script>

<div class="container">
  <div class="row">
    <div class="col-12 col-sm-6">
    <br/>
    <br/>
      <div class="text-center">
        <h3>Smoked Meat Selection</h3>
      </div>
      <div class="col-10 offset-1">
        <ul class="meatlist">
        <br />
          <%= simple_form_for @rfq do |f| %>
            <%=f.collection_check_boxes(:meats, @meats.all, :id, :name, checked: @meats.where(selected: true).map(&:id) ) do |b| %>
              <li><%=b.check_box("data-value": b.value, "data-text": b.text, class: "meat") %><%=b.label(class: "meat_name")%>
            <%end%></li>
            <br/>
        </ul>
        
      </div>
    </div>
    <div class="col-12 col-sm-6">
    <br/>
    <br/>
      <div class="text-center">
        <h3>Side Dishes</h3>
      </div>
      <div class="col-10 offset-1">
        <ul class="sidelist">
        <br />
            <%=f.collection_check_boxes( :sides, @sides.all, :id, :name) do |b| %>
              <li>
                <%=b.check_box(class: "side") %>
                <%=b.label("data-value": b.value, class: "side_name")%>
            <%end%>
              </li>
              <br/>
        </ul>
      </div>
    </div>
  </div>
  <div class="col text-center">
            <%= f.submit 'Enter', class: 'btn btn-primary ', method: :put %>
          <% end %>
   </div>
   <div class="col">
      <h4><%=@rfq%></h4>
      
      <h4><%= @rfq.meats_ordered(@rfq.meats)%></h4>
   </div>
   
</div>

